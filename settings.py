import os
from dotenv import load_dotenv

load_dotenv()

class Settings:

    # MinIO/S3 settings
    MINIO_ENDPOINT = os.getenv("MINIO_ENDPOINT", "")
    MINIO_ACCESS_KEY = os.getenv("MINIO_ACCESS_KEY", "")
    MINIO_SECRET_KEY = os.getenv("MINIO_SECRET_KEY", "")
    MINIO_BUCKET_NAME = os.getenv("MINIO_BUCKET_NAME", "")
    MINIO_SECURE = os.getenv("MINIO_SECURE", "true")
    MINIO_REGION = os.getenv("MINIO_REGION", "")

    # Ollama settings
    OLLAMA_HOST = os.getenv("OLLAMA_HOST", "")
    OLLAMA_MODEL = os.getenv("OLLAMA_MODEL", "qwen2.5:32b")
    OLLAMA_TEMPERATURE = float(os.getenv("OLLAMA_TEMPERATURE", "0"))
    OLLAMA_TOP_P = float(os.getenv("OLLAMA_TOP_P", "0.5"))
    OLLAMA_NUM_PREDICT_PAIR = int(os.getenv("OLLAMA_NUM_PREDICT_PAIR", "5096"))
    OLLAMA_NUM_PREDICT_FINAL = int(os.getenv("OLLAMA_NUM_PREDICT_FINAL", "34048"))
    
    # Document processing settings
    OUTPUT_FILE = os.getenv("OUTPUT_FILE", "./summary.txt")
    ALLOWED_EXTENSIONS = os.getenv("ALLOWED_EXTENSIONS", ".txt,.md").split(",")
    MAX_CHUNK_SIZE = int(os.getenv("MAX_CHUNK_SIZE", "5000"))
    CHUNK_OVERLAP = int(os.getenv("CHUNK_OVERLAP", "200"))
    MAX_WORKERS = int(os.getenv("MAX_WORKERS", "4"))
    SHUFFLE_CHUNKS = os.getenv("SHUFFLE_CHUNKS", "false").lower() == "true"
    
    # Summary settings
    FINAL_STYLE = os.getenv("FINAL_STYLE", "narrative")
    TARGET_BULLETS_PAIR = int(os.getenv("TARGET_BULLETS_PAIR", "40"))
    TARGET_BULLETS_FINAL = int(os.getenv("TARGET_BULLETS_FINAL", "120"))
    MIN_FINAL_SENTENCES = int(os.getenv("MIN_FINAL_SENTENCES", "15"))
    
    # Prompt settings
    SYSTEM_PROMPT = os.getenv("SYSTEM_PROMPT", """Ты — эксперт-аналитик по обработке информации. Твоя задача — анализировать тексты и извлекать конкретные данные, сохраняя всю ценную информацию. Действуй согласно следующим правилам:

1.  **ТОЧНОСТЬ:** Работай только с предоставленной информацией. Не добавляй и не придумывай ничего от себя.
2.  **ПРИОРИТЕТ ДАННЫХ:** В первую очередь извлекай и сохраняй:
    - Имена, фамилии, должности, названия компаний
    - Контакты: email, телефоны, физические адреса, URL
    - Числовые данные: даты, суммы, номера договоров, ID
    - Технические данные: логины, ключи, токены (если присутствуют)
    - Важные факты, выводы, решения
3.  **ЯЗЫК:** Всегда отвечай на русском языке.
4.  **СТРУКТУРА:** Используй четкую организацию информации, маркированные списки для удобства восприятия.
5.  **КОНТЕКСТ:** Определи тип документа (договор, отчет, письмо и т.д.) и его общую цель.

Текст для анализа:""")

    MERGE_PROMPT = os.getenv("MERGE_PROMPT", """[ЗАДАЧА]: Объедини два представленных фрагмента в ЕДИНОЕ структурированное резюме. Не пересказывай их по отдельности, а синтезируй общую картину.

**ИНСТРУКЦИЯ ПО СЛИЯНИЮ:**
1.  **СОХРАНИ ВСЕ КЛЮЧЕВЫЕ ДАННЫХ:** Обязательно включи в результат:
    - Все имена, организации, контактную информацию из обоих фрагментов
    - Все числовые значения (даты, суммы, номера)
    - Все важные факты и выводы
2.  **УБЕРИ ДУБЛИРОВАНИЕ:** Если одна и та же информация встречается в обоих фрагментах, представь ее один раз.
3.  **ВОССТАНОВИ КОНТЕКСТ:** Определи тип общего документа и его основную цель на основе объединенной информации.
4.  **ФОРМАТ:** Представь результат в структурированном виде, готовом для следующего цикла обработки. Используй краткие пункты и списки.

**КРИТИЧЕСКИ ВАЖНО:** Этот результат будет использоваться для дальнейшего объединения с другими такими же резюме. Он должен быть информативно насыщенным и компактным.

Промежуточные документы для объединения:""")

    FINAL_PROMPT = os.getenv("FINAL_PROMPT","""[ЗАДАЧА]: На основе предоставленных промежуточных суммаризаций создай итоговый, исчерпывающий отчет по всему документу (или набору документов). Это финальная версия, которая должна содержать всю самую ценную информацию для пользователя.

**ИНСТРУКЦИЯ ДЛЯ ФИНАЛЬНОГО ОТЧЕТА:**
1.  **Структура:** Представь информацию в четко структурированном виде. Используй следующие разделы:
    *   **Общая характеристика документа:** Тип, цель, основная тема.
    *   **Ключевые субъекты:** Основные лица, организации, их роли и взаимосвязи.K
    *   **Извлеченные данные:** Списком все конкретные данные: контакты, даты, финансовые суммы, номера, прочая важная конкретика.
    *   **Содержательная summary:** Основные выводы, заключения, выявленные проблемы, возможности и рекомендации.
2.  **Полнота:** Это последний этап, поэтому убедись, что ни одна важная деталь из промежуточных шагов не утеряна.
3.  **Ясность:** Излагай информацию четко, кратко и максимально информативно. Избегай двусмысленностей.

Итогом должен быть профессиональный отчет, по которому пользователь сможет понять все ключевые аспекты исходного документа, состоящего из множества предыдущих.
""")        

settings = Settings()


